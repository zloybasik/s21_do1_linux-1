# Работа с Ubuntu 20.04 Server LTS

## Содержание
1. [Установка ОС](#часть-1-установка-ос) 

## Часть 1. Установка ОС
![Part_1_1.png](Screenshots/Part_1_1.png)

- Скачать установочный образ ОС (iso) https://old-releases.ubuntu.com/releases/20.04/
- Скачать программу для виртуализации https://www.virtualbox.org/wiki/Downloads
- Создание виртуальной машины (ВМ)
  - Запустить VirtualBox 
  - Нажать Создать
  - Задать имя ВМ - `d01-linux-1`
  - Выбрать образ iso - `ubuntu-20.04-live-server-amd64.iso` -> Далее
  - Задать имя пользователя и пароль. Задать имя хоста -> Далее
  - Задать количество оперативной памяти. Задать количество процессоров -> Далее
  - Создать новый виртуальный диск. Выбрать размер диска -> Далее -> Готово
- Установка ОС
  - Запускаем созданную машину в VirtualBox
  - Выбрать язык
  - Продолжить без обновления
  - Выбрать раскладку клавиатуру -> Готово
  - Настройка сети -> Готово
  - Настройка прокси-сервера -> Готово
  - Настройка сервера обновлений -> Готово
  - Разметка диска -> Готово
  - Конфигуратор хранилища -> Готово
  - Подтвердить разрушительное действие -> Продолжить
  - Настройка учетной записи
    - Задать имя
    - Задать название сервера
    - Задать имя пользователя и пароль
    - Готово
  - Подтверждаем необходимость установки OpenSSH сервера
  - Импортировать идентификатор SSH - НЕТ -> Готово
  - Выбираем рекомендуемые снимки сервера -> Готово
  - Выбор компонентов сервера -> Готово
  - Установка завершена - Ожидаем скачивание и установку обновлений систем безопасности
  - По окончании установки -> Перезагрузка
- Ввести логин и пароль
- Узнать версию Ubuntu, выполнив команду `cat /etc/issue.`

![Part_1_2.png](Screenshots/Part_1_2.png)

>Разультат работы команды `cat /etc/issue`.

<br>

## Часть 2. Создание пользователя

- Создание нового пользователя в группе adm

![Part_2_1.png](Screenshots/Part_2_1.png)

>Вызов команды для создания пользователя.

![Part_2_2.png](Screenshots/Part_2_2.png)

>Разультат работы команды `cat /etc/passwd`.

<br>

## Часть 3. Настройка сети ОС

- Задать название машины вида user-1

![Part_3_1.png](Screenshots/Part_3_1.png)

>Вызов команды для переименования машины.

![Part_3_2.png](Screenshots/Part_3_2.png)

>После перезагрузки системы hostname изменился

- Установить временную зону, соответствующую вашему текущему местоположению.

![Part_3_3.png](Screenshots/Part_3_3.png)

>Вызов команды для установки временной зоны.

- Вывести названия сетевых интерфейсов с помощью консольной команды.

![Part_3_4.png](Screenshots/Part_3_4.png)

>Вызов команды для вывода названий сетевых интерфейсов.

`lo` - loopback interface - это виртуальный сетевой интерфейс, который компьютер использует для связи с самим собой при работе серверных приложений.

- Используя консольную команду получить ip адрес устройства, на котором вы работаете, от DHCP сервера.

![Part_3_5.png](Screenshots/Part_3_5.png)

>Вызов команды для получения ip адреса текущего устройства от DHCP-сервера.

`DHCP` - Dynamic Host Configuration Protocol  - протокол динамической настройки узла.

- Определить и вывести на экран внешний ip-адрес шлюза (ip) и внутренний IP-адрес шлюза, он же ip-адрес по умолчанию (gw).

![Part_3_6.png](Screenshots/Part_3_6.png)

>Вызов команд для определения внешнего ip-адреса шлюза.

![Part_3_7.png](Screenshots/Part_3_7.png)

>Вызов команд для определения внутреннего ip-адреса шлюза.

- Задать статичные (заданные вручную, а не полученные от DHCP сервера) настройки ip, gw, dns (использовать публичный DNS серверы, например 1.1.1.1 или 8.8.8.8).

![Part_3_8.png](Screenshots/Part_3_8.png)

>Для изменения настроек вводим команду `
`, отключаем dhcp и добавляем адреса. 

- Перезагрузить виртуальную машину. Убедиться, что статичные сетевые настройки (ip, gw, dns) соответствуют заданным в предыдущем пункте.

      sudo reboot

![Part_3_9.png](Screenshots/Part_3_9.png)

>Пинг удаленных хостов 1.1.1.1 и ya.ru.

<br>

## Часть 4. Обновление ОС

- Обновить системные пакеты до последней на момент выполнения задания версии.

      sudo apt update

      sudo apt upgrade 

![Part_4_1.png](Screenshots/Part_4_1.png)

>Вызов команды обновления ( sudo apt update )

![Part_4_2.png](Screenshots/Part_4_2.png)

>Процесс апргрейда пакетов ( sudo apt upgrade ). Забыл сделать скриншот с указанием самой команды sudo apt upgrade.

![Part_4_3.png](Screenshots/Part_4_3.png)

>Апгрейд окончен, показываю последнюю использованную команду, т.е sudo apt upgrade .

![Part_4_4.png](Screenshots/Part_4_4.png)

>Вызов команды обновления повторно, для подтверждения отсутствия обновления.

<br>

## Часть 5. Использование команды **sudo**

- Разрешить пользователю, созданному в [Часть 2](#часть-2-создание-пользователя), выполнять команду sudo

      sudo usermod -aG sudo localuser

`sudo` - Super User DO - позволяет строго определенным пользователям выполнять команды с правами администратора.

- Поменять hostname ОС от имени пользователя, созданного в пункте [Часть 2](#часть-2-создание-пользователя) (используя sudo).

![Part_5.png](Screenshots/Part_5.png)

>Создание пароля ранее созданному пользователю и вызов команды для переименования машины.

<br>

## Часть 6. Установка и настройка службы времени

- Настроить службу автоматической синхронизации времени.

      sudo apt install ntpdate

      sudo ntpdate -qu 1.ro.pool.ntp.org

![Part_6.png](Screenshots/Part_6.png)

>Вызов команды для вывода времени и часового пояса.

<br>

## Часть 7. Установка и использование текстовых редакторов 

- Установить текстовой редактор **VIM**.

      sudo apt install vim

- Cоздать файл *test_VIM.txt*. Написать в нём свой никнейм, закрыть файл с сохранением изменений.

      touch test_VIM.txt
      vim test_VIM.txt

![Part_7_1.png](Screenshots/Part_7_1.png)

>Cодержимое файла test_VIM.txt перед закрытием. Для редактирования файла нажать `i`. После ввода текста `esc`. Для выхода с сохранением изменений `:wq` или `ZZ`.

- Отредактировать файл, заменив никнейм на строку "21 School 21", закрыть файл без сохранения изменений

![Part_7_2.png](Screenshots/Part_7_2.png)

>Cодержимое файла test_VIM.txt после редактирования. Редактирование файла: удаляем первую строку `dd`, затем входим в режим редактирования `i`, набираем текст. После редактирования `esc`. Для выхода без сохранениния изменений `:q!`.

- Поиск по содержимому файла.

![Part_7_3.png](Screenshots/Part_7_3.png)

>Команда для замены слова на другое `:s/<find_text>/<replace_text>`.

- Замена слова на любое другое.

***
<br>

![Part_7_4.png](Screenshots/Part_7_4.png)

- Установить текстовой редактор **NANO**.

      sudo apt install nano

![Part_7_5.png](Screenshots/Part_7_5.png)

- Cоздать файл *test_NANO.txt*. Написать в нём свой никнейм, закрыть файл с сохранением изменений.

      touch test_NANO.txt
      nano test_NANO.txt

![Part_7_6.png](Screenshots/Part_7_6.png)

>Cодержимое файла test_NANO.txt перед закрытием. Для редактирования вводить текст. Для выхода с сохранением изменений `control + x` ( Part_7_5.png ), затем `y` и `enter`.

![Part_7_7.png](Screenshots/Part_7_7.png)

- Отредактировать файл, заменив никнейм на строку "21 School 21", закрыть файл без сохранения изменений

>Cодержимое файла test_NANO.txt после редактирования. Редактирование файла: удаляем первую строку, затем набираем текст. Для выхода без сохранениния изменений `control + x`, затем `n`.

- Поиск по содержимому файла.

![Part_7_8.png](Screenshots/Part_7_8.png)

>Команда для замены слова на другое `control + \`, вводим искомое слово, затем `enter`, вводим замену, `enter`, и `y`.

***
<br>

- Установить текстовой редактор **MCEDIT**.

      sudo apt install mcedit

- Cоздать файл *test_MCEDIT.txt*. Написать в нём свой никнейм, закрыть файл с сохранением изменений.

      touch test_MCEDIT.txt
      mcedit test_MCEDIT.txt

![Part_7_9.png](Screenshots/Part_7_9.png)

>Cодержимое файла test_MCEDIT.txt перед закрытием. Для редактирования вводить текст. Для выхода с сохранением изменений `esc` или `F10`, затем выбрать `Да`.

- Отредактировать файл, заменив никнейм на строку "21 School 21", закрыть файл без сохранения изменений

![Part_7_10.png](Screenshots/Part_7_10.png)

>Cодержимое файла test_MCEDIT.txt после редактирования. Редактирование файла: удаляем первую строку, затем набираем текст. Для выхода без сохранениния изменений `esc` или `F10`, затем выбрать `Нет`.

- Поиск по содержимому файла.

![[Part_7_11.png](Screenshots/[Part_7_11.png)

>Результаты поиска слова. Поиск осуществляется через нажатие `F7` и ввода искомого слова, затем `enter`, курсор должен находится перед искомым словом.

- Замена слова на любое другое.

![Part_7_12.png](Screenshots/Part_7_12.png)

>Команда для замены слова на другое `F4`, вводим искомое слово, вводим зеамену, `enter`, и еще раз `enter`.

>Список трёх файлов с разными редакторами.

<br>

## Часть 8. Установка и базовая настройка сервиса **SSHD**

- Установить службу SSHd.

      sudo apt update
      sudo apt install ssh
      sudo apt install openssh-server

- Добавить автостарт службы при загрузке системы.

      sudo systemctl enable ssh

- Перенастроить службу SSHd на порт 2022.

      sudo vim /etc/ssh/sshd_config

![Part_8_1.png](Screenshots/Part_8_1.png)

>Меняем *#Port 22* на *Port 2022*

      sudo systemctl restart sshd

- Используя команду ps, показать наличие процесса sshd.

![Part_8_2.png](Screenshots/Part_8_2.png)

>Вызов команды для вывода процесса по его имени.

`ps` - команда, которая выводит статистику и информацию о состоянии процессов в системе, в том числе ИД процесса или нити, объем выполняемого ввода-вывода и используемый объем ресурсов процессора и памяти. \
Список ключей: \
-A, -e, (a) - выбрать все процессы; \
-a - выбрать все процессы, кроме фоновых; \
-d, (g) - выбрать все процессы, даже фоновые, кроме процессов сессий; \
-N - выбрать все процессы кроме указанных; \
-С - выбирать процессы по имени команды; \
-G - выбрать процессы по ID группы; \
-p, (p) - выбрать процессы PID; \
--ppid - выбрать процессы по PID родительского процесса; \
-s - выбрать процессы по ID сессии; \
-t, (t) - выбрать процессы по tty; \
-u, (U) - выбрать процессы пользователя.

- Перезагрузить систему.

      sudo reboot

- Вывод команды netstat -tan

      sudo apt install net-tools

![Part_8_3.png](Screenshots/Part_8_3.png)

>Вызов команды для вывода списка открытых портов и соответствующих им адресов, таблиц маршрутизации и скрытых соединений. \
Список ключей: \
-t - Отображение текущего подключения в состоянии переноса нагрузки с процессора на сетевой адаптер при передаче данных ( "offload" ); \
-a - Отображение всех подключений и ожидающих портов; \
-n - Отображение адресов и номеров портов в числовом формате.

`Proto` - Протокол, используемый сокетом.

`Recv-Q` - Счётчик байт не скопированных программой пользователя из этого сокета.

`Send-Q` - Счётчик байтов, не подтверждённых удалённым узлом.

`Local Address` - Адрес и номер порта локального конца сокета. Если не указана опция --numeric (-n), адрес сокета преобразуется в каноническое имя узла (FQDN), и номер порта преобразуется в соответствующее имя службы.

`Foreign Address` - Адрес и номер порта удалённого конца сокета. Аналогично "Local Address."

`State` - Состояние сокета.

`0.0.0.0` -  это немаршрутизируемый адрес IPv4, который используется в качестве адреса по умолчанию или адреса-заполнителя.

<br>

## Часть 9. Установка и использование утилит **top**, **htop**

- Установить и запустить утилиты top. 

      top

![Part_9_1.png](Screenshots/Part_9_1.png)

>Вызов команды top. \
uptime - 8:00 \
количество авторизованных пользователей - 1 \
общая загрузка системы - 0.06, 0.09, 0.06\
общее количество процессов - 150 \
загрузка cpu - 0.0 us, 0.0 sy, 0.0 ni, 100.0 id, 0.0 wa, 0.0 hi, 0.0 si, 0.0 st \
загрузка памяти - 9615.4 total, 8697.8 free, 227.4 used, 960.2 buff/cache \
pid процесса занимающего больше всего памяти - 1\
pid процесса, занимающего больше всего процессорного времени - 1

- Установить и запустить утилиты htop. 

      htop

![Part_9_2.png](Screenshots/Part_9_2.png)

>Вызов команды htop и сортировка по PID

![Part_9_3.png](Screenshots/Part_9_3.png)

>Cортировка по PERCENT_CPU

![Part_9_4.png](Screenshots/Part_9_4.png)

>Сортировка по PERCENT_MEM

![Part_9_5.png](Screenshots/Part_9_5.png)

>Сортировка по TIME

![Part_9_6.png](Screenshots/Part_9_6.png)

>Фильтр по sshd

![Part_9_7.png](Screenshots/Part_9_7.png)

>Поиск по syslog

![Part_9_8.png](Screenshots/Part_9_8.png)

>Добавлен вывод hostname, clock и uptime

<br>

## Часть 10. Использование утилиты **fdisk**

- Запустить команду fdisk -l.

      sudo fdisk -l

![Part_10_1.png](Screenshots/Part_10_1.png)

>Вызов команды для получения информации о жёстком диске. \

![Part_10_2.png](Screenshots/Part_10_2.png)

>Вызов команды для получения информации о размере swap на жёстком диске.

<br>

## Часть 11. Использование утилиты **df** 

- Запустить команду df.

![Part_11_1.png](Screenshots/Part_11_1.png)

>Вызов команды для получения информации о дисковом пространстве. \

- Запустить команду df -Th.

![Part_11_2.png](Screenshots/Part_11_2.png)

>Вызов команды для получения информации о дисковом пространстве с типом файловой системы и размерами в читаемом виде. \


<br>

## Часть 12. Использование утилиты **du**

- Запустить команду du.

![Part_12_1.png](Screenshots/Part_12_1.png)

>Вызов команды для получения информации о размере всех файлов в определённой папке

- Вывести размер папок /home, /var, /var/log (в байтах, в человекочитаемом виде)

![Part_12_2.png](Screenshots/Part_12_2.png)

>Вызов команды для получения информации о размере папок /home, /var, /var/log в байтах.

![Part_12_3.png](Screenshots/Part_12_3.png)

>Вызов команды для получения информации о размере папок /home, /var, /var/log в человекочитаемом виде.

- Вывести размер всего содержимого в /var/log (не общее, а каждого вложенного элемента, используя *)

![Part_12_4.png](Screenshots/Part_12_4.png)

>Вызов команды для получения информации о размере всего содержимого в /var/log в человекочитаемом виде.

<br>

## Часть 13. Установка и использование утилиты **ncdu**

- Установить утилиту ncdu.

      sudo apt install ncdu

- Вывести размер папок /home, /var, /var/log.

![Part_13_1.png](Screenshots/Part_13_1.png)

>Вызов команды для получения информации о размере папки /home.

![Part_13_2.png](Screenshots/Part_13_2.png)

>Вызов команды для получения информации о размере папки /var.

![Part_13_3.png](Screenshots/Part_13_3.png)

>Вызов команды для получения информации о размере папки /var/log.

<br>

## Часть 14. Работа с системными журналами

- Открыть для просмотра /var/log/dmesg

![Part_14_1.png](Screenshots/Part_14_1.png)

>Вывод файла vim /var/log/dmesg

- Открыть для просмотра /var/log/syslog

![Part_14_2.png](Screenshots/Part_14_2.png)

>Вывод файла vim /var/log/syslog

- Открыть для просмотра /var/log/auth.log

![Part_14_3.png](Screenshots/Part_14_3.png)

>Вывод файла vim /var/log/auth.log

- Перезапустить службу SSHd.

      sudo systemctl restart sshd

![Part_14_4.png](Screenshots/Part_14_4.png)

>Вывод файла /var/log/syslog с сообщением о рестарте службы SSHd.

<br>

## Часть 15. Использование планировщика заданий **CRON**

- Используя планировщик заданий, запустите команду uptime через каждые 2 минуты.

      crontab -e

![Part_15_1.png](Screenshots/Part_15_1.png)

>Редактирование планировщика задач, путем добавления новой строки с текстом `*/2 * * * * uptime`.

- Найти в системных журналах строчки (минимум две в заданном временном диапазоне) о выполнении.

![Part_15_2.png](Screenshots/Part_15_2.png)

>Вывод данных из файла /var/log/syslog со строками о выполнении запуска команды uptime через каждые 2 минуты.

- Вывести на экран список текущих заданий для CRON.

![Part_15_3.png](Screenshots/Part_15_3.png)

>Вывод списка текущих заданий для CRON.

>Удаление всех заданий планировщика и вывод списка текущих заданий для CRON.